Cluster Visualization - Created a complete visualization system with 4 different plot types showing cluster formation, timeline, trust metrics, and performance analysis

Trust-Based Clustering - Fully integrated the trust system with clustering algorithms, achieving 75% malicious node detection and ensuring only trustworthy vehicles become cluster heads

Message Delivery Bug - Fixed the critical bug where messages weren't being received by correcting the timestamp to use simulation time instead of system time

Dynamic Vehicle Animation - Implemented real vehicle movement with motion trails in browser-based HTML5 Canvas animations, replacing static visualizations with moving vehicles on highway lanes

City Traffic Simulation - Created complex 3Ã—3 grid city simulation with 9 intersections, 24 road segments, realistic traffic lights (red/yellow/green with proper timing), and vehicles that stop/go/turn appropriately

Real-World Location Integration - Added OpenStreetMap integration to simulate VANET clustering on actual street networks from any location worldwide (Times Square, Shibuya Crossing, etc.) using OSMnx library with lat/lon coordinate conversion


#new added stuff : 
# VANET Simulation Visualizations - Detailed Explanations


### What's Happening:
- **150 vehicles** deployed across **11Ã—11 Manhattan-style grid** with highway corridor
- Vehicles randomly placed on road segments with varying types (cars, trucks, emergency)
- **~18 malicious nodes** (12%) distributed throughout network
- Initial neighbor discovery via DSRC (250-pixel communication range)

### Visual Elements:
- Gray lines = Road network
- Green dots = Regular member vehicles
- Small black dots = Intersections with traffic lights
- Network spans 3300Ã—3300 pixels (~10.89 million pixelsÂ²)

### Key Metrics:
- Total clusters: 0 (initial state)
- Communication range: 250 pixels
- Road segments: 350
- Intersections: 97

---


### What's Happening:
- Vehicles have formed **5-12 dynamic clusters** based on:
  - **Proximity** (within 450-pixel radius)
  - **Speed similarity** (Â±15 m/s)
  - **Direction alignment** (Â±57 degrees)
- Dashed circles show cluster boundaries (centered on cluster centroid)
- Cluster merging algorithm prevents sub-clustering

### Visual Elements:
- Dashed colored circles = Cluster boundaries
- Each color represents a distinct cluster
- Circle size = Cluster radius (max 450 pixels)
- Vehicles grouped by proximity

### Algorithm Details:
```python
# Clustering criteria:
- max_cluster_radius = 450 pixels (3 blocks diameter)
- speed_threshold = 15.0 m/s
- direction_threshold = 1.0 radians (~57 degrees)
- Merging if: leaders within 450px AND >30% member overlap
```

---


### What's Happening:
- **Multi-Metric Raft Elections** completed
- ðŸŸ¡ **Gold circles (â™•)** = Cluster Leaders (27 total)
- ðŸ”´ **Red circles (â˜…)** = Co-Leaders (27 total, one per cluster)
- Leaders elected using composite score:
  - Trust (30%), Connectivity (25%), Stability (20%), Centrality (15%), Tenure (10%)

### Visual Elements:
- **Leader (Gold)**: Positioned at cluster center with highest composite score
- **Co-Leader (Red)**: Second-best candidate, ready for automatic succession
- Cluster circles centered on leader position (not geometric center)

### Election Process:
1. Filter out malicious nodes (trust < 0.5)
2. Calculate 5-metric composite score for each candidate
3. Trust-weighted Raft voting (51% majority required)
4. Winner becomes leader, runner-up becomes co-leader

### Succession Logic:
- If leader fails â†’ Co-leader **immediately** takes over
- If both fail â†’ Full re-election triggered
- Elections only on failure (not periodic)

---

### What's Happening:
- **Multi-hop relay system** operational
- ðŸ”µ **Cyan circles (âš¡)** = Relay Nodes (3-9 total)
  - Forward messages to out-of-range cluster members
  - Selected based on: Trust (35%), Centrality (25%), Stability (20%), Coverage (20%)
- ðŸŸ£ **Pink circles (â—ˆ)** = Boundary Nodes (0-56 total)
  - Gateway nodes for inter-cluster communication
  - Connect neighboring clusters within 600-pixel range

### Communication Flow:
```
Intra-Cluster (via Relays):
Leader â†’ Relay Node â†’ Out-of-range Member

Inter-Cluster (via Boundaries):
Cluster A Leader â†’ A Boundary â†’ B Boundary â†’ Cluster B Leader
```

### Visual Elements:
- **Relay nodes**: Enable 1.42 average hops for relayed messages
- **Boundary nodes**: Facilitate 540-1,030 inter-cluster messages
- Lines between nodes show communication paths

---



### What's Happening:
- **Proof-of-Authority (PoA)** malicious detection active
- ðŸŸ£ **Purple circles** = Flagged malicious nodes (13-18 detected)
- **100% detection rate** achieved
- Authority nodes (trust > 0.8) vote within their cluster
- **30% cluster authority threshold** for flagging

### Detection Process:
1. **Suspicion Scoring** (0-1.2 scale):
   - Trust < 0.4: +0.3
   - Known malicious: +0.5
   - Speed > 75 mph: +0.2
   - Message spam (>100 messages): +0.2

2. **Cluster-Based Voting**:
   - Authorities in same cluster vote
   - Requires 30% of cluster authorities to flag
   - Isolated nodes monitored by nearby authorities (300px)

3. **Penalties**:
   - Trust reduced by 30% (Ã—0.7)
   - Removed from cluster head position
   - Force cluster re-election

### Visual Elements:
- Purple nodes have low trust (< 0.4)
- Positioned throughout network (not clustered)
- Authorities shown as high-trust green/gold nodes

---

## 6. V2V Safety Messages

### What's Happening:
- **Vehicle-to-Vehicle (V2V) communication** active
- **14,000-19,000 total messages** exchanged
- Message types visible:
  - **Collision Warnings** (4,070): Red halos around vehicles
  - **Lane Change Alerts** (1,454): Yellow indicators
  - **Emergency Alerts** (1,485): Orange broadcasts
  - **Brake Warnings** (743): Blue signals
  - **Traffic Jam Alerts** (11,993): Purple zones

### Communication Statistics:
```
Total Messages: 19,584
â”œâ”€â”€ Collision Warnings: 4,070 (21%)
â”œâ”€â”€ Traffic Jam Alerts: 11,993 (61%)
â”œâ”€â”€ Lane Change Alerts: 1,454 (7%)
â”œâ”€â”€ Emergency Alerts: 1,485 (8%)
â””â”€â”€ Brake Warnings: 743 (4%)

Multi-Hop Relay: 274 messages (1.12 avg hops)
Inter-Cluster: 540 messages (via 56 boundary nodes)
```

### Safety Features:
1. **Collision Detection**:
   - 1-second future position prediction
   - 30-pixel collision threshold
   - speed reduction upon warning

2. **Lane Change Coordination**:
   - Intent broadcast before change
   - Safety verification with neighbors
   - 50-pixel safe distance requirement

3. **Emergency Vehicle Priority**:
   - Broadcasts every 2 seconds
   - Recipients reduce speed by 50%
   - Ignore traffic lights when active

### Visual Elements:
- Connecting lines = Active message transmission
- Color intensity = Message frequency
- Cluster boundaries show relay/boundary forwarding paths

---

## Summary Statistics Across All Frames

| Metric | Value | Description |
|--------|-------|-------------|
| **Total Vehicles** | 150 | Cars, trucks, emergency vehicles |
| **Malicious Nodes** | 13-18 | ~12% of network |
| **Clusters Formed** | 3-12 | Dynamic, merged clusters |
| **Leader Elections** | 104-331 | Failure-driven (not periodic) |
| **PoA Detection Rate** | 100% | All malicious nodes flagged |
| **V2V Messages** | 11,000-19,000 | Per 120-second simulation |
| **Relay Nodes** | 1-9 | Multi-hop coverage |
| **Boundary Nodes** | 0-56 | Inter-cluster gateways |
| **Average Trust** | 0.886-0.918 | Network-wide trust score |

---

## How to Use These Visualizations in Your Report

### For Introduction/Overview:
- Use **Initial Clustering** to show network topology
- Reference 11Ã—11 grid, 350 roads, 97 intersections

### For Clustering Algorithm Section:
- Use **Cluster Formation** to demonstrate dynamic clustering
- Highlight proximity, speed, and direction criteria
- Show cluster merging preventing sub-clusters

### For Leader Election (Raft) Section:
- Use **Leader Election** to show multi-metric voting
- Explain gold = leader, red = co-leader
- Reference 5-metric composite scoring

### For Security (PoA) Section:
- Use **Malicious Detection** to show 100% detection
- Explain cluster-scoped authority voting
- Reference 30% threshold

### For Multi-Hop Communication Section:
- Use **Relay & Boundary** to show relay forwarding
- Explain intra-cluster (relay) vs inter-cluster (boundary)
- Reference 1.42 average hops

### For V2V Safety Features Section:
- Use **V2V Communication** to show all message types
- Reference collision warnings, lane changes, emergency alerts
- Show multi-hop relay statistics

---

## Captions for Each Image (Copy-Paste Ready)

**Figure 1: Initial Network State**
> 150 vehicles deployed across 11Ã—11 Manhattan-style grid with highway corridor. Network spans 3300Ã—3300 pixels with 350 road segments and 97 traffic-controlled intersections.

**Figure 2: Dynamic Cluster Formation**
> Vehicles form 5-12 dynamic clusters based on proximity (450px radius), speed similarity (Â±15 m/s), and direction alignment (Â±57Â°). Cluster merging prevents sub-clustering.

**Figure 3: Multi-Metric Raft Leader Election**
> Gold nodes (â™•) represent cluster leaders elected via trust-weighted Raft voting. Red nodes (â˜…) are co-leaders providing automatic succession on failure. Leaders positioned at cluster centers.

**Figure 4: Relay & Boundary Node Communication**
> Cyan nodes (âš¡) are relay nodes enabling multi-hop intra-cluster communication (avg 1.42 hops). Pink nodes (â—ˆ) are boundary nodes facilitating inter-cluster message forwarding (540+ messages).

**Figure 5: PoA Malicious Node Detection**
> Purple nodes flagged as malicious by Proof-of-Authority voting. Authority nodes (trust > 0.8) achieve 100% detection rate using cluster-scoped 30% threshold voting.

**Figure 6: V2V Safety Communication**
> 19,584 V2V messages exchanged including collision warnings (4,070), lane change alerts (1,454), and emergency broadcasts (1,485). Multi-hop relay system ensures network-wide coverage.

---

*All visualizations generated from 120-second simulation with 241 captured frames at 0.5-second intervals.*